<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<ui:composition template="/WEB-INF/template.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <ui:define name="bodyJR">
    <f:metadata>
        <f:event type="preRenderView" listener="#{beanMenu.changeRutaMenu('changePassword')}"/>
        <f:event type="preRenderView" listener="#{beanUsers.showChangePassword}"/>
    </f:metadata>
        
    <h:form id="changePassword">
    <p:growl id="messages" showDetail="true" showSummary="true"/>
    <p:panel id="panelUsers">
    <br></br><br></br>
    <fieldset>
    <table align="center">
        <tr>
            <th colspan="2">
                <h:outputText value="#{props['com.jr.props.menu.tools.cc']}"
                              style="font-size: 18px; text-decoration: underline;"/>
            </th>
        </tr>
        <tr>
            <td>
                <br></br>
            </td>
        </tr>
        <tr>
        <td align="right"><h:outputLabel value="#{props['com.jr.props.menu.cat.users.id_usuario']} : "/></td>
        <td><h:outputText value="#{beanUsers.dominio.user}" style="font-weight: bold;"/></td>
        </tr>
        <tr><td align="right"><h:outputLabel for="txtPassword" value="#{props['com.jr.props.change.password.new']} : "/></td>
        <td><p:password id="txtPassword" value="#{beanUsers.dominio.password}" required="true" 
        label="#{props['com.jr.props.change.password.new']}" requiredMessage="#{props['com.jr.field']} '#{props['com.jr.props.change.password.new']}' #{props['com.jr.is.required']}"
        disabled="#{beanUsers.dominio.disabled}"/></td>
        <td><p:message for="txtPassword" display="icon"/></td></tr>
        <tr><td align="right"><h:outputLabel for="txtConfirmarPassword" value="#{props['com.jr.props.menu.cat.users.password.confirmar']} : "/></td>
        <td><p:password id="txtConfirmarPassword" value="#{beanUsers.password}" required="true" 
        label="#{props['com.jr.props.menu.cat.users.password.confirmar']}" requiredMessage="#{props['com.jr.field']} '#{props['com.jr.props.menu.cat.users.password.confirmar']}' #{props['com.jr.is.required']}"
        disabled="#{beanUsers.dominio.disabled}"/></td>
        <td><p:message for="txtConfirmarPassword" display="icon"/></td></tr>
        <tr>
        <td align="right"><h:outputLabel value="#{props['com.jr.props.menu.cat.users.user']} : "/></td>
        <td>
        <h:outputText value="#{beanUsers.dominio.usuarios.nombre}" style="font-weight: bold;"/>&nbsp;
        <h:outputText value="#{beanUsers.dominio.usuarios.app}" style="font-weight: bold;"/>&nbsp;
        <h:outputText value="#{beanUsers.dominio.usuarios.apm}" style="font-weight: bold;"/>
        </td>
        </tr>

        <tr>
            <td colspan="2" align="right">
                <p:commandButton id="btnAceptar"
                update="panelUsers :changePassword:messages"
                actionListener="#{beanUsers.changePassword}" 
                value="#{props['com.jr.props.btn.aceptar']}" 
                oncomplete="validateData(args);"/>
            </td>
        </tr>
    </table>
    </fieldset>
    </p:panel>
    </h:form>
        
    <script type="text/javascript">
    function validateData(args) {
        if(args.validationFailed) {
            alert("#{props['com.jr.props.titulo.verifica.datos']}");
        } else if(args.statusTransaction == false) {
            alert(args.errorTransaction);
        } else {
            alert(args.msgSuccess);
        }
    }
    </script>
    </ui:define>
</ui:composition>
